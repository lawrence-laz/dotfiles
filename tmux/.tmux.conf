# ----------------------------------------------------------------
# Key mappings
# ----------------------------------------------------------------
# <leader>?         List key bindings
# <leader>L         Go to last session
# <leader>c         Create window
# <leader>n         Go to next window
# TODO: Simplify sessionizer? https://www.youtube.com/watch?v=M5FLi05_ePk

set -g detach-on-destroy off
set -a terminal-features "tmux-256color:RGB"
set -g base-index 1
set -g window-status-current-style "fg=blue bold"
set -g status-right "" # TODO: Create `swatch` and use it as task timer with "task name: duration".
set -g status-left "#S"

bind r source-file ~/.tmux.conf

set-window-option -g mode-keys vi

set -g status-position top
set -g status-justify absolute-centre
set -g status-style "bg=default"
set -g status on

bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi V send -X select-line
# bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Disable esc delay, this presumably disabled using esc as meta, but I don't care about that
set -sg escape-time 0

bind Enter copy-mode
# Use xorg clipboard
#bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'
# bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -i -f -selection primary | xclip -i -selection clipboard"
# bind -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "wl-copy"

set -g mouse on

# Search
bind-key / copy-mode \; send-key ?

# Custom commands
# To view currently active bindings run: tmux list-keys
# NOTE: tmux is weird about how bindings are saved. Just removing them from config file is not enough.
# Execute via <c-b>:
# Just need to unbind before assigning?
unbind f
bind f run-shell "tmux neww ~/git/dotfiles/.scripts/tmux-cd.sh"
bind x kill-pane

# Session picker with sessions ordered by name
unbind s
bind s choose-tree -sZ -O name

# Window control
unbind -
bind \\ split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %
# This is some weird void screen
unbind C-z

# Cycle between panes full screen
unbind ]
unbind l
unbind [
bind -r l select-pane -t .+1 \; resize-pane -Z
bind -r [ select-pane -t .-1 \; resize-pane -Z

# Keybindings while in copy mode
bind-key -T copy-mode-vi 'C-h' select-pane -L
bind-key -T copy-mode-vi 'C-j' select-pane -D
bind-key -T copy-mode-vi 'C-k' select-pane -U
bind-key -T copy-mode-vi 'C-l' select-pane -R
bind-key -T copy-mode-vi 'C-\' select-pane -l

